<?php/** * Created by PhpStorm. * User: gyw * Date: 2017/4/30 * Time: 下午5:40 */namespace Common\Model;use think\Exception;use Think\Model;class MenuModel extends Model {    private $_db;    /**     * MenuModel constructor     */    public function __construct()    {        $this->_db = M("menu");    }    public function insert($data = array()) {        if(!$data || !is_array($data)) {            return 0;        }        return $this->_db->add($data);    }    public function getMenus($data = array(), $pageIndex = 1, $pageSize = 3) {        //不显示已经删除的数据        $data['status'] = array('neq', -1);        $offset = ($pageIndex - 1) * $pageSize;        return $this->_db->where($data)->order("listorder desc, menu_id asc")->limit($offset, $pageSize)->select();    }    public function getMenusCount($data = array()) {        $data['status'] = array('neq', -1);        return $this->_db->where($data)->count();    }    public function getMenuDataById($id) {        if(!$id || !is_numeric($id)) {            return array();        }        return $this->_db->where('menu_id='.$id)->find();    }    public function updateMenuDataById($id, $data) {        if(!$id || !is_numeric($id)) {            E("ID不合法");        }        if(!$data || !is_array($data)) {            E("数据不合法");        }        return $this->_db->where('menu_id='.$id)->save($data);    }    //修改status状态    public function updateStatusById($id, $status) {        if(!$id || !is_numeric($id)) {            E("ID不合法");        }        if(!$status || !is_numeric($status)) {            E("状态不合法");        }        $data['status'] = $status;        return $this->_db->where('menu_id='.$id)->save($data);    }    //设置listorder排序    public function updateListorderById($id, $listorder = 0) {        if(!$id || !is_numeric($id)) {            E("ID不合法");        }        if(!$listorder || !is_numeric($listorder)) {            $listorder = 0;        }//        $data['listorder'] = $listorder;        $data = array(            'listorder' => intval($listorder),        );        return $this->_db->where('menu_id='.$id)->save($data);    }    public function getAdminMenus() {        $data = array(            'status' => array('neq', -1),            'type' => 1,        );        return $this->_db->where($data)->order('listorder desc, menu_id asc')->select();    }}